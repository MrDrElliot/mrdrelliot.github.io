<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">Dr. Elliot - Character Optimizations</title>
<meta property="og:title" content=Dr.&#32;Elliot&#32;-&#32;Character&#32;Optimizations />
<meta name="twitter:title" content=Dr.&#32;Elliot&#32;-&#32;Character&#32;Optimizations />
<meta itemprop="name" content=Dr.&#32;Elliot&#32;-&#32;Character&#32;Optimizations />
<meta name="application-name" content=Dr.&#32;Elliot&#32;-&#32;Character&#32;Optimizations />
<meta property="og:site_name" content="Dr. Elliot" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="http://localhost:1313/optimization/characteroptimizations/" />
<link rel="canonical" href="http://localhost:1313/optimization/characteroptimizations/" itemprop="url" />
<meta name="url" content="http://localhost:1313/optimization/characteroptimizations/" />
<meta name="twitter:url" content="http://localhost:1313/optimization/characteroptimizations/" />
<meta property="og:url" content="http://localhost:1313/optimization/characteroptimizations/" />


<meta property="og:updated_time" content="2024-08-28T00:00:00Z" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='http://localhost:1313/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="Dr. Elliot" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.132.2">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.94a339836f89f0d25f31980cb6b0631da21e20af128308747ce44e0525eb16ef.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="http://localhost:1313/">
                <img src="https://github.com/mrdrelliot.png" alt="brand image">
            </a>
        
        
            <a href="http://localhost:1313/">
                <h1>Dr. Elliot</h1>
            </a>
        
    </h1>
    <p class="lead">
    A collection of things I've learned using Unreal Engine.
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about/">About</a>
                    </li>
                    
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
            
                
                
            
                
                
            
        
        
            

            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/general/">General</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/general/bpvscpp/">Blueprint vs C&#43;&#43;: Different Tools for Different Jobs</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/general/constexpr/">Constexpr and Consteval</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/general/inheritenceoveruse/">Overuse of Inheritence, alternatives.</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/general/lambdadangers/">The dangers of Lambdas</a>
                            </li>
                        
                    
                
            
                
                
            
                
                
            
                
                
            
                
                
            
            
                
                
            
                
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/optimization/">Optimizations</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/optimization/thecastscare/">The Cast Scare</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/optimization/characteroptimizations/">Character Optimizations</a>
                            </li>
                        
                    
                
            
            
                
                
            
                
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/networking/">Networking</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/networking/networkserialization/">Network Serialization</a>
                            </li>
                        
                    
                
            
                
                
            
            
                
                
            
                
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/memory/">Memory</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/memory/tarrayallocators/">TArray Allocators</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/memory/templateobjecttypes/">Templated Object Types</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/memory/softreferences/">What Are Soft References?</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/memory/buffers/">Working With Buffers</a>
                            </li>
                        
                    
                
            
                
                
            
                
                
            
            
                
                
            
                
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/gas/">Gameplay Ability System</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/gas/intro/">Intro</a>
                            </li>
                        
                    
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
            
                
                
            
                
                
            
        

    </ul>
</nav>

        








    <a target="_blank" class="social" title="Discord" href="https://discord.gg/WTqSFrBg6t">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24">
            <path fill="currentColor" d="M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.09.09 0 0 0-.07.03c-.18.33-.39.76-.53 1.09a16.09 16.09 0 0 0-4.8 0c-.14-.34-.35-.76-.54-1.09c-.01-.02-.04-.03-.07-.03c-1.5.26-2.93.71-4.27 1.33c-.01 0-.02.01-.03.02c-2.72 4.07-3.47 8.03-3.1 11.95c0 .02.01.04.03.05c1.8 1.32 3.53 2.12 5.24 2.65c.03.01.06 0 .07-.02c.4-.55.76-1.13 1.07-1.74c.02-.04 0-.08-.04-.09c-.57-.22-1.11-.48-1.64-.78c-.04-.02-.04-.08-.01-.11c.11-.08.22-.17.33-.25c.02-.02.05-.02.07-.01c3.44 1.57 7.15 1.57 10.55 0c.02-.01.05-.01.07.01c.11.09.22.17.33.26c.04.03.04.09-.01.11c-.52.31-1.07.56-1.64.78c-.04.01-.05.06-.04.09c.32.61.68 1.19 1.07 1.74c.03.01.06.02.09.01c1.72-.53 3.45-1.33 5.25-2.65c.02-.01.03-.03.03-.05c.44-4.53-.73-8.46-3.1-11.95c-.01-.01-.02-.02-.04-.02zM8.52 14.91c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.84 2.12-1.89 2.12zm6.97 0c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.83 2.12-1.89 2.12z"/>
        </svg>
    </a>










    <a target="_blank" class="social" title="Email" href="mailto://mrdrelliot@gmail.com">
       <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 485.211 485.211">
            <path fill="currentColor" d="M301.393,241.631L464.866,424.56H20.332l163.474-182.928l58.801,51.443L301.393,241.631z M462.174,60.651H23.027 l219.579,192.142L462.174,60.651z M324.225,221.67l160.986,180.151V80.792L324.225,221.67z M0,80.792v321.029L160.972,221.64 L0,80.792z"/>
       </svg>
    </a>




        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2024 Dr. Elliot. All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="http://localhost:1313/optimization/characteroptimizations/">Character Optimizations</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2024-08-28T00:00:00Z" class="post-date">
        August 28, 2024
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>2 mins read</span>
      </span>
    </div>

    
  </div>

  
  

  
</div>

  <p>Hello! I wanted to talk about some ways to improve performance while using a large number of characters. I see a lot of issues with games that utilize <code>ACharacter</code> for their large scale AI.
A good example is a zombie hoarde system, so that&rsquo;s what we will be using as an example for this blog.</p>
<p>We will be discussing two types of optimizations, client optimizations and server optimizations. All of these tests are being conducted on Unreal 5.4.3, but still apply all the way back to Unreal 4.26.</p>
<h1 id="before-optimizations">Before Optimizations:</h1>
<p><img src="../Before.png" alt="Before"></p>
<h1 id="after-optimizations">After Optimizations:</h1>
<h1 id="client-optimizations">Client Optimizations</h1>
<p><strong>Client optimizations</strong> are those that affect characters on <strong>simulated proxies</strong>, (Characters that are <em>simulated</em> on our local player). This cost often comes from these two virtual functions found in <code>CharacterMovementComponent.h</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">/** Special Tick for Simulated Proxies */</span>
</span></span><span style="display:flex;"><span>	ENGINE_API <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SimulatedTick</span>(<span style="color:#66d9ef">float</span> DeltaSeconds);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">/** Simulate movement on a non-owning client. Called by SimulatedTick(). */</span>
</span></span><span style="display:flex;"><span>	ENGINE_API <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SimulateMovement</span>(<span style="color:#66d9ef">float</span> DeltaTime);
</span></span></code></pre></div><p>This is the setup we will be using for the AI, extremely basic. <strong>Please do not use Get Actor Of Class, this is merely just for ease-of-testing</strong></p>
<p>With default movement, and 201 ACharacters, we can see from earlier the performance is&hellip; not optimal.</p>
<p>As we can see, a large cost is stemming from the skeletal mesh, the animation blueprint, and the Character Movement Component. So let&rsquo;s start with the Character Movement Component first.</p>
<p>Unforunately this is where Blueprint will leave us for the time being, as most of these optimizations will need to be done in C++.</p>
<p>Let&rsquo;s create a new CharacterMovementComponent class.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>UCLASS(ClassGroup<span style="color:#f92672">=</span>(Custom), meta<span style="color:#f92672">=</span>(BlueprintSpawnableComponent))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UOptimizedCharacterMovementComponent</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> UCharacterMovementComponent
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	GENERATED_BODY()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	UOptimizedCharacterMovementComponent();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BeginPlay</span>() <span style="color:#66d9ef">override</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">TickComponent</span>(<span style="color:#66d9ef">float</span> DeltaTime, ELevelTick TickType, FActorComponentTickFunction<span style="color:#f92672">*</span> ThisTickFunction) <span style="color:#66d9ef">override</span>;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>Set the new character movement component on your character.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>AOptimizedCharacter<span style="color:#f92672">::</span>AOptimizedCharacter(<span style="color:#66d9ef">const</span> FObjectInitializer<span style="color:#f92672">&amp;</span> ObjectInitializer)
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">:</span>Super(ObjectInitializer.SetDefaultSubobjectClass(CharacterMovementComponentName, UOptimizedCharacterMovementComponent<span style="color:#f92672">::</span>StaticClass()))
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	PrimaryActorTick.bCanEverTick <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
  
  <hr>
<div class="footer">
    
	    
	    
            <div class="next-post">
                <a href="http://localhost:1313/optimization/thecastscare/?ref=footer"><span style="font-weight:bold;">Next »</span><br>The Cast Scare</a>
            </div>
        
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents"></nav>
    </div>
</div>

  

        </div>
    </body>
</html>
