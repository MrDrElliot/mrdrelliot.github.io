<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js"></script>





  



    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">Dr. Elliot - TArray Allocators</title>
<meta property="og:title" content=Dr.&#32;Elliot&#32;-&#32;TArray&#32;Allocators />
<meta name="twitter:title" content=Dr.&#32;Elliot&#32;-&#32;TArray&#32;Allocators />
<meta itemprop="name" content=Dr.&#32;Elliot&#32;-&#32;TArray&#32;Allocators />
<meta name="application-name" content=Dr.&#32;Elliot&#32;-&#32;TArray&#32;Allocators />
<meta property="og:site_name" content="Dr. Elliot" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="https://mrdrelliot.github.io/memory/tarrayallocators/" />
<link rel="canonical" href="https://mrdrelliot.github.io/memory/tarrayallocators/" itemprop="url" />
<meta name="url" content="https://mrdrelliot.github.io/memory/tarrayallocators/" />
<meta name="twitter:url" content="https://mrdrelliot.github.io/memory/tarrayallocators/" />
<meta property="og:url" content="https://mrdrelliot.github.io/memory/tarrayallocators/" />


<meta property="og:updated_time" content="2024-08-16T14:31:08-05:00" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://mrdrelliot.github.io/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="Dr. Elliot" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.132.2">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.94a339836f89f0d25f31980cb6b0631da21e20af128308747ce44e0525eb16ef.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="https://mrdrelliot.github.io/">
                <img src="https://github.com/mrdrelliot.png" alt="brand image">
            </a>
        
        
            <a href="https://mrdrelliot.github.io/">
                <h1>Dr. Elliot</h1>
            </a>
        
    </h1>
    <p class="lead">
    A collection of things I've learned using Unreal Engine.
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about/">About</a>
                    </li>
                    
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
            
                
                
            
                
                
            
        
        
            

            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/general/">General</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="https://mrdrelliot.github.io/general/bpvscpp/">Blueprint vs C&#43;&#43;: Different Tools for Different Jobs</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://mrdrelliot.github.io/general/constexpr/">Constexpr and Consteval</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://mrdrelliot.github.io/general/inheritenceoveruse/">Overuse of Inheritence, alternatives.</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://mrdrelliot.github.io/general/lambdadangers/">The dangers of Lambdas</a>
                            </li>
                        
                    
                
            
                
                
            
                
                
            
                
                
            
                
                
            
            
                
                
            
                
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/optimization/">Optimizations</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="https://mrdrelliot.github.io/optimization/thecastscare/">The Cast Scare</a>
                            </li>
                        
                    
                
            
            
                
                
            
                
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/networking/">Networking</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="https://mrdrelliot.github.io/networking/networkserialization/">Network Serialization</a>
                            </li>
                        
                    
                
            
                
                
            
            
                
                
            
                
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/memory/">Memory</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="https://mrdrelliot.github.io/memory/movesemantics/">Move Semantics</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://mrdrelliot.github.io/memory/tarrayallocators/">TArray Allocators</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://mrdrelliot.github.io/memory/templateobjecttypes/">Templated Object Types</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://mrdrelliot.github.io/memory/softreferences/">What Are Soft References?</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://mrdrelliot.github.io/memory/buffers/">Working With Buffers</a>
                            </li>
                        
                    
                
            
                
                
            
                
                
            
            
                
                
            
                
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/gas/">Gameplay Ability System</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="https://mrdrelliot.github.io/gas/intro/">Intro</a>
                            </li>
                        
                    
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
            
                
                
            
                
                
            
        

    </ul>
</nav>

        








    <a target="_blank" class="social" title="Discord" href="https://discord.gg/WTqSFrBg6t">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24">
            <path fill="currentColor" d="M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.09.09 0 0 0-.07.03c-.18.33-.39.76-.53 1.09a16.09 16.09 0 0 0-4.8 0c-.14-.34-.35-.76-.54-1.09c-.01-.02-.04-.03-.07-.03c-1.5.26-2.93.71-4.27 1.33c-.01 0-.02.01-.03.02c-2.72 4.07-3.47 8.03-3.1 11.95c0 .02.01.04.03.05c1.8 1.32 3.53 2.12 5.24 2.65c.03.01.06 0 .07-.02c.4-.55.76-1.13 1.07-1.74c.02-.04 0-.08-.04-.09c-.57-.22-1.11-.48-1.64-.78c-.04-.02-.04-.08-.01-.11c.11-.08.22-.17.33-.25c.02-.02.05-.02.07-.01c3.44 1.57 7.15 1.57 10.55 0c.02-.01.05-.01.07.01c.11.09.22.17.33.26c.04.03.04.09-.01.11c-.52.31-1.07.56-1.64.78c-.04.01-.05.06-.04.09c.32.61.68 1.19 1.07 1.74c.03.01.06.02.09.01c1.72-.53 3.45-1.33 5.25-2.65c.02-.01.03-.03.03-.05c.44-4.53-.73-8.46-3.1-11.95c-.01-.01-.02-.02-.04-.02zM8.52 14.91c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.84 2.12-1.89 2.12zm6.97 0c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.83 2.12-1.89 2.12z"/>
        </svg>
    </a>










    <a target="_blank" class="social" title="Email" href="mailto://mrdrelliot@gmail.com">
       <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 485.211 485.211">
            <path fill="currentColor" d="M301.393,241.631L464.866,424.56H20.332l163.474-182.928l58.801,51.443L301.393,241.631z M462.174,60.651H23.027 l219.579,192.142L462.174,60.651z M324.225,221.67l160.986,180.151V80.792L324.225,221.67z M0,80.792v321.029L160.972,221.64 L0,80.792z"/>
       </svg>
    </a>




        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2024 Dr. Elliot. All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="https://mrdrelliot.github.io/memory/tarrayallocators/">TArray Allocators</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2024-08-16T14:31:08-0500" class="post-date">
        August 16, 2024
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>4 mins read</span>
      </span>
    </div>

    
  </div>

  
  

  
</div>

  <h1 id="understanding-tarray-allocators-in-unreal-engine">Understanding TArray Allocators in Unreal Engine</h1>
<hr>
<p>Unreal Engine&rsquo;s <code>TArray</code> is a powerful and flexible container that allows you to manage dynamic arrays in your code. One of its lesser-known yet incredibly useful features is the ability to specify custom allocators. These allocators determine how the memory for the array is allocated and managed, which can have a significant impact on performance, especially in memory-constrained environments.</p>
<p>I personally <strong>highly</strong> recommend taking a look at the <code>VoxelCore</code> library that&rsquo;s open source on Github, they wrote lots of incredibly performant containers that are worth a lot at.</p>
<p>In this article, we&rsquo;ll explore the different types of <code>TArray</code> allocators available in Unreal Engine, with examples demonstrating how and when to use them.</p>
<h3 id="default-allocator-fdefaultallocator">Default Allocator (<strong>FDefaultAllocator</strong>)</h3>
<p><strong>Purpose:</strong> The default allocator used by <code>TArray</code> if no other allocator is specified. It provides a general-purpose, dynamic allocation strategy that works well in most cases.</p>
<p><strong>Use Case:</strong> Use the default allocator when you need a dynamic array that grows as needed, with no specific memory constraints.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>TArray<span style="color:#f92672">&lt;</span>int32<span style="color:#f92672">&gt;</span> MyArray; <span style="color:#75715e">// Uses FDefaultAllocator by default
</span></span></span></code></pre></div><h3 id="inline-allocator-tinlineallocator">Inline Allocator (<strong>TInlineAllocator&lt;&gt;</strong>)</h3>
<p><strong>Purpose:</strong> The inline allocator allows you to specify a fixed number of elements that will be allocated inline (within the array&rsquo;s memory footprint) before falling back to dynamic allocation. This can reduce heap allocations and improve performance when the array is small or has a known upper bound.</p>
<p><strong>Use Case:</strong> Use <code>TInlineAllocator</code> when you expect your array to be small most of the time, and you want to avoid heap allocations for those small cases.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>TArray<span style="color:#f92672">&lt;</span>uint32, TInlineAllocator<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">4</span><span style="color:#f92672">&gt;&gt;</span> InlineArray; <span style="color:#75715e">// Inlines up to 4 elements before allocating on the heap
</span></span></span></code></pre></div><p><strong>Example:</strong> Suppose you have an array that typically holds 1-4 elements, but occasionally needs to hold more. The <code>TInlineAllocator&lt;4&gt;</code> will handle the typical case without allocating heap memory, providing a performance boost.</p>
<h3 id="fixed-allocator-tfixedallocator">Fixed Allocator (<strong>TFixedAllocator&lt;&gt;</strong>)</h3>
<p><strong>Purpose:</strong> The fixed allocator pre-allocates a fixed block of memory for the array, meaning the array cannot grow beyond the specified size. This can be useful in performance-critical situations where you need to avoid dynamic memory allocation entirely.</p>
<p><strong>Use Case:</strong> Use <code>TFixedAllocator</code> when you know the maximum size of your array and need to ensure that no additional memory allocation occurs at runtime.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>TArray<span style="color:#f92672">&lt;</span>int32, TFixedAllocator<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">16</span><span style="color:#f92672">&gt;&gt;</span> FixedArray; <span style="color:#75715e">// Can hold exactly 16 elements, no more, no less
</span></span></span></code></pre></div><p><strong>Example:</strong> In a scenario where you need a small, fixed-size array (e.g., an array of 16 elements for vertex data in a shader), <code>TFixedAllocator&lt;16&gt;</code> would provide deterministic performance with no risk of runtime allocations.</p>
<h3 id="heap-allocator-theapallocator">Heap Allocator (<strong>THeapAllocator&lt;&gt;</strong>)</h3>
<p><strong>Purpose:</strong> The heap allocator explicitly allocates memory on the heap for the array, similar to the default allocator but more explicitly defined. This is useful when you want to ensure that the array&rsquo;s memory is always allocated on the heap.</p>
<p><strong>Use Case:</strong> Use <code>THeapAllocator</code> when you need to guarantee that the array’s memory is allocated on the heap, regardless of its size or usage patterns.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>TArray<span style="color:#f92672">&lt;</span>int32, THeapAllocator<span style="color:#f92672">&gt;</span> HeapArray; <span style="color:#75715e">// Always allocates on the heap
</span></span></span></code></pre></div><p><strong>Example:</strong> When working with large datasets or arrays that may grow significantly during runtime, <code>THeapAllocator</code> ensures that memory is dynamically allocated on the heap, allowing the array to expand as needed.</p>
<h3 id="special-allocators-custom-allocators">Special Allocators (Custom Allocators)</h3>
<p><strong>Purpose:</strong> Unreal Engine allows you to create custom allocators by inheriting from the base <code>FMemoryAllocator</code> class. This provides full control over how memory is allocated, aligned, and freed.</p>
<p><strong>Use Case:</strong> Use a custom allocator when you have specific memory management requirements that aren&rsquo;t met by the existing allocators. This might include specialized alignment requirements or pooling strategies.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FMyCustomAllocator</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> FMemoryAllocator
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Custom allocator implementation here
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TArray<span style="color:#f92672">&lt;</span>int32, FMyCustomAllocator<span style="color:#f92672">&gt;</span> CustomArray;
</span></span></code></pre></div><p><strong>Example:</strong> Suppose you&rsquo;re developing a real-time system with unique memory alignment or allocation requirements. A custom allocator would allow you to implement those requirements directly within the <code>TArray</code>.</p>
<h3 id="conclusion">Conclusion</h3>
<p>Choosing the right allocator for your <code>TArray</code> can have a significant impact on your game&rsquo;s performance and memory usage. The default allocator is a good general-purpose choice, but when you need more control—whether to avoid heap allocations, limit memory usage, or meet specific performance criteria—inline, fixed, heap, or custom allocators can provide the solution.</p>
<p>Understanding these allocators and how to use them effectively can help you write more efficient, optimized code in Unreal Engine. Whether you&rsquo;re working on a small mobile game or a large AAA title, these tools give you the flexibility to manage memory in a way that best suits your project&rsquo;s needs.</p>

  
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="https://mrdrelliot.github.io/memory/templateobjecttypes/?ref=footer"><span style="font-weight:bold;">« Previous</span><br>Templated Object Types</a>
        
	    
            <div class="next-post">
                <a href="https://mrdrelliot.github.io/memory/movesemantics/?ref=footer"><span style="font-weight:bold;">Next »</span><br>Move Semantics</a>
            </div>
        
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#default-allocator-fdefaultallocator">Default Allocator (<strong>FDefaultAllocator</strong>)</a></li>
        <li><a href="#inline-allocator-tinlineallocator">Inline Allocator (<strong>TInlineAllocator&lt;&gt;</strong>)</a></li>
        <li><a href="#fixed-allocator-tfixedallocator">Fixed Allocator (<strong>TFixedAllocator&lt;&gt;</strong>)</a></li>
        <li><a href="#heap-allocator-theapallocator">Heap Allocator (<strong>THeapAllocator&lt;&gt;</strong>)</a></li>
        <li><a href="#special-allocators-custom-allocators">Special Allocators (Custom Allocators)</a></li>
        <li><a href="#conclusion">Conclusion</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
